<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR&display=swap" rel="stylesheet">
  <link rel="manifest" href="./manifest.json" />
  <title>암기노트</title>
  <link rel="stylesheet" href="Study.css">
</head>
<body>
  <div class="app" role="application" aria-label="퀴즈 보드">

    <!-- ▼ 메인 화면 -->
    <div class="screen" id="screen">
      <button id="resetBtn" class="icon-btn reset">🔄</button>
      <button id="invertButton" class="icon-btn reset">☯</button>
      <button class="fab">⚙️</button>

      <!-- 중앙 주제 목록 -->
      <div id="topicWrap" class="topic-wrap">
        <button id="bookmarkBtn" class="btn slim">북마크</button>
        <div id="placeholder" class="placeholder">여기에 주제 버튼이 생성됩니다</div>
      </div>
    </div>

    <!-- ▼ 북마크(즐겨찾기) 화면: 플립과 동일한 카드 토글 UI -->
    <div id="starScreen" class="screen" style="display:none;">
      <div class="flip-header">
        <div class="input-like" id="starTopicName">북마크</div>
        <div class="flip-meta">
          <span id="starIndexLabel"></span>
          <!-- m/s/a는 생략 가능; 필요 시 id 더 추가 -->
        </div>
        <button id="starHomeBtn" class="btn btn-primary slim">Home</button>
      </div>
    
      <div class="flip-toolbar">
        <div class="spacer"></div>
        <button id="starFontPlus" class="chip">➕</button>
        <button id="starFontMinus" class="chip">➖</button>
      </div>
    
      <div id="starCard" class="flip-card" role="button" aria-label="카드 토글(앞/뒤)"></div>
    
      <div class="flip-bottom">
        <button id="starPrev" class="btn slim">◀</button>
        <button id="starStar" class="btn slim">★</button>
        <button id="starNext" class="btn slim">▶</button>
      </div>
    </div>

    <!-- ▼ 새 뷰: 토픽 상세/모드 선택 화면 -->
    <div id="detailScreen" class="screen" style="display:none;">

      <div class="detail-wrap">
        <div id="detailTitle" class="input-like">아까 누른 버튼 텍스트</div>
        <br>
        <button id="detailFlipBtn" class="mode-btn">플립 모드</button>
        <button id="detailCurtBtn" class="mode-btn">휘장 모드</button>
        <button id="detailMemoryBtn" class="mode-btn">퀴즈 모드</button>
      </div>

      <div class="detail-home">
        <button id="homeBtn" class="btn btn-primary">Home</button>
      </div>
    </div>
    
    <!-- ▼ 플립 모드 화면 -->
    <div id="flipScreen" class="screen" style="display:none;">
    
      <!-- 상단 헤더 -->
      <div class="flip-header">
        <div class="hometext" id="flipTopicName">토픽 버튼 텍스트</div>
        <div class="flip-meta">
          <span id="flipIndexLabel">팝업 명에 따른 이름</span>
        </div>
        <button id="flipHomeBtn" class="btn btn-primary slim">Home</button>
      </div>
    
      <!-- 툴바 -->
      <div class="flip-toolbar">
        <button id="flipHint" class="chip">💡</button>
        <button id="flipHintBtn" class="chip" style="display: none;">💡</button>
        <button id="flipEditBtn" class="chip" style="display: none;">연필</button>
        <div class="spacer"></div>
        <button id="flipRandBtn" class="chip">🔀</button>
        <button id="flipMoveBtn" class="chip">➤</button>
        <button id="flipSearchBtn" class="chip">🔎</button>
        <button id="flipAutoBtn" class="chip">🤖</button>
        <button id="flipFontPlus" class="chip">➕</button>
        <button id="flipFontMinus" class="chip">➖</button>
      </div>
    
      <!-- 카드 표시 영역 -->
      <div id="flipCard" class="flip-card" role="button" aria-label="카드 토글(앞/뒤)">
        <!-- JS로 내용 주입 -->
      </div>
    
      <!-- 하단 네비 -->
      <div class="flip-bottom">
        <button id="flipPrev" class="btn slim">◀</button>
        <button id="flipStar" class="btn slim">☆</button>
        <button id="flipNext" class="btn slim">▶</button>
      </div>
    </div>
    
    <!-- ▼ 휘장 모드 화면 -->
    <div id="curtainScreen" class="screen" style="display:none;">

      <div class="flip-header">
        <div class="hometext" id="curTopicName">토픽 버튼 텍스트</div>
        <div class="flip-meta">
          <span id="curIndexLabel">1</span>

        </div>
        <button id="curHomeBtn" class="btn btn-primary slim">Home</button>
      </div>
    
      <!-- 툴바: hint / 연필 / 빙(휘장 투명 토글) -->
      <div class="flip-toolbar">
        <button id="curHint" class="chip">💡</button>
        <button id="curHintBtn" class="chip" style="display: none;">💡</button>
        <button id="curEditBtn" class="chip" style="display: none;">연필</button>
        <button id="curOpacityBtn" class="chip">🧊</button>
        <div class="spacer"></div>
        <button id="curRandBtn" class="chip">🔀</button>
        <button id="curMoveBtn" class="chip">➤</button>
        <button id="curSearchBtn" class="chip">🔎</button>
        <button id="curAutoBtn" class="chip">🤖</button>
      </div>
    
      <!-- 본문: 위/아래 1:1, 오른쪽에 각각 폰트 ± -->
      <div id="curBody" class="cur-body">
        <div class="cur-top" id="curTopArea">
          <div id="curTopText" class="cur-text">top</div>
          <!-- 위쪽 버튼 세트 -->
          <div class="cur-fontcol cur-fontcol-top">
            <div class="font-group top-group">
              <button id="curTopPlus" class="chip">➕</button>
              <button id="curTopMinus" class="chip">➖</button>
            </div>
          </div>
        </div> 
        <div class="cur-bottom" id="curBottomArea">
          <div id="curBottomText" class="cur-text">bottom</div>
          <!-- 노란 휘장: under 영역을 덮는 오버레이 -->
          <div id="curCurtain" class="cur-curtain"></div>
          <!-- 아래쪽 버튼 세트 -->
          <div class="cur-fontcol cur-fontcol-bottom">
            <div class="font-group bottom-group">
              <button id="curBottomPlus" class="curBottomFont chip">➕</button>
              <button id="curBottomMinus" class="curBottomFont chip">➖</button>
            </div>
          </div>
        </div>
      </div>
    
      <!-- 하단 네비: ◀ ☆ ▶ (동작은 플립과 동일, 항상 t로 이동) -->
      <div class="flip-bottom">
        <button id="curPrev" class="btn slim">◀</button>
        <button id="curStar" class="btn slim">☆</button>
        <button id="curNext" class="btn slim">▶</button>
      </div>
    </div>

    <!-- ▼ 퀴즈 모드 화면 -->
    <div id="memoryScreen" class="screen" style="display:none;">
      <div class="flip-header">
        <div class="hometext" id="memTopicName">토픽 버튼 텍스트</div>
        <div class="flip-meta">
          <span id="memIndexLabel">1</span>
        </div>
        <button id="memHomeBtn" class="btn btn-primary slim">Home</button>
      </div>
    
      <div class="mem-stats">
        <button id="memHint" class="chip">💡</button>
        정답 개수: <b id="memCorrectCount">0</b>
        <div class="spacer"></div>
        <button id="memRandBtn" class="chip">🔀</button>
        <button id="memMoveBtn" class="chip">➤</button>
        <button id="memSearchBtn" class="chip">🔎</button>
        <button id="memAutoBtn" class="chip">🤖</button>
      </div>

      <div class="mem-wrap">
        <!-- 질문 -->
        <div id="memQuestion" class="mem-q">질문</div>
    
        <!-- 보기 4칸: JS로 주입 (각 칸 우측에 +/-) -->
        <div id="memOptions" class="mem-options"></div>
      </div>
    
      <div class="flip-bottom">
        <button id="memPrev" class="btn slim">◀</button>
        <button id="memStar" class="btn slim">☆</button>
        <button id="memNext" class="btn slim">▶</button>
      </div>
    </div>

    <!-- 삭제 모드 전용 취소 버튼 (삭제 모드에서만 표시) -->
    <button id="cancelDeleteBtn" class="btn cancel-delete" style="display:none;">취소</button>

    <!-- 하단 3버튼 -->
    <div class="bottom" role="toolbar" aria-label="하단 조작">
      <button id="upBtn"  class="btn" aria-label="업로드" style="font-size: 1.2em !important;">⬆</button>
      <button id="addBtn" class="btn btn-primary" aria-label="추가">+</button>
      <button id="delBtn" class="btn btn-danger"  aria-label="삭제">-</button>
    </div>
  </div>

  <!-- 설정 팝업 -->
  <div id="settingsPopup" class="popup settings-popup">
    <div class="popup-content">
      <h2>⚙️ 설정</h2>
      <button id="popupResetBtn" class="btn">🔄 모든 데이터 초기화</button>
      <button id="openOrderBtn" class="btn">🔀 순서 바꾸기</button>
      <button id="popupInvertBtn" class="btn">☯ 색 반전 모드</button>
      <button id="popupStorageBtn" class="btn">💾 로컬 사용량 확인</button>
      <button id="popupBackupBtn" class="btn">.TXT로 추출하기</button>
    </div>
  </div>

  <!-- 이름 편집 팝업 -->
  <div id="namingPopup" class="namingPopup" style="display:none;">
    <div class="namingPopup__panel" role="dialog" aria-modal="true" aria-labelledby="namingTitle">
      <div id="namingTitle" class="namingPopup__title">주제 이름 편집</div>
      <input id="namingInput" class="namingPopup__input" type="text" placeholder="이름을 입력하세요" />
      <div class="namingPopup__actions">
        <button id="namingCancel" class="btn">취소</button>
        <button id="namingSave" class="btn btn-primary">저장</button>
      </div>
    </div>
  </div>

  <!-- 공통 수정 팝업 -->
  <div id="editPopup" class="namingPopup" style="display:none;">
    <div class="namingPopup__panel">
      <div class="namingPopup__title">카드 내용 수정</div>
      <textarea id="editInput" class="namingPopup__input" rows="4"></textarea>
      <div class="namingPopup__actions">
        <button id="editCancelBtn" class="btn">취소</button>
        <button id="editSaveBtn" class="btn btn-primary">저장</button>
      </div>
    </div>
  </div>

  <!-- 새 모달: 토픽 순서 변경 -->
  <div id="orderModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="orderModalTitle">
    <div class="modal-inner">
      <h2 id="orderModalTitle">토픽 순서 변경</h2>
      <p class="muted">드래그하여 토픽의 순서를 바꾸십시오. 저장하면 로컬에 보관되고 즉시 화면에 반영됩니다.</p>  
      <ul id="orderList" class="order-list">
      </ul>
      <div class="modal-actions">
        <button id="saveOrderBtn" class="btn primary">저장</button>
        <button id="cancelOrderBtn" class="btn">취소</button>
      </div>
    </div>
  </div>
  
  <!-- 모달을 닫는 배경(선택사항) -->
  <div id="orderModalBackdrop" class="modal-backdrop hidden"></div>


  <!-- Move 팝업 -->
  <div id="movePopup" class="movePopup" style="display:none;">
    <div class="movePopupPanel">
      <div class="movePopuTitle">번호 이동</div>
  
      <input id="moveInput" class="movePopupInput" type="number" placeholder="번호 입력" />
  
      <div class="movePopupActions" style="margin-top:12px;">
        <button id="moveJump" class="btn">- 10</button>
        <button id="moveSuperJump" class="btn">- 20</button>
        <button id="moveOk" class="btn btn-primary">이동</button>
        <button id="moveCancel" class="btn">취소</button>
      </div>
    </div>
  </div>

  <!-- 토스트 -->
  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script src="Study.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(reg => console.log("SW 등록 성공:", reg))
        .catch(err => console.error("SW 등록 실패:", err));
    }
  </script>
</body>
</html>
